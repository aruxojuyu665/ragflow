---
sidebar_position: 1
slug: /start_chat
---

# Запуск AI-чата

Инициируйте чат с искусственным интеллектом с настроенным чат-ассистентом.

---

База знаний, чат без галлюцинаций и управление файлами — три столпа RAGFlow. Чаты в RAGFlow основаны на конкретном наборе данных или нескольких наборах данных. После создания набора данных, завершения парсинга файлов и [проведения теста поиска](../dataset/run_retrieval_test.md) вы можете приступить к запуску AI-разговора.

## Запуск AI-чата

Вы начинаете AI-разговор, создавая ассистента.

1. Нажмите вкладку **Chat** в верхней средней части страницы **>** **Create an assistant**, чтобы открыть диалоговое окно **Chat Configuration** *вашего следующего диалога*.

   > RAGFlow предоставляет гибкость выбора разных моделей чата для каждого диалога, при этом позволяя установить модели по умолчанию в **System Model Settings**.

2. Обновите настройки, специфичные для ассистента:

   - **Assistant name** — имя вашего чат-ассистента. Каждый ассистент соответствует диалогу с уникальным сочетанием наборов данных, подсказок (prompts), конфигураций гибридного поиска и настроек больших моделей.
   - **Empty response**:
     - Если вы хотите *ограничить* ответы RAGFlow вашими наборами данных, укажите здесь ответ. Тогда, если ответ не будет найден, система *одинаково* ответит тем, что вы здесь задали.
     - Если вы хотите, чтобы RAGFlow *импровизировал*, когда не находит ответ в наборах данных, оставьте поле пустым, что может привести к появлению галлюцинаций.
   - **Show quote**: ключевая функция RAGFlow, включена по умолчанию. RAGFlow не работает как «черный ящик». Вместо этого он явно показывает источники информации, на которых основаны его ответы.
   - Выберите соответствующие наборы данных. Можно выбрать один или несколько наборов, но убедитесь, что они используют одну и ту же модель встраивания (embedding model), иначе возникнет ошибка.

3. Обновите настройки, специфичные для подсказок (Prompt):

   - В разделе **System** заполните подсказки для вашего LLM, можно также оставить подсказку по умолчанию для начала.
   - **Similarity threshold** задаёт порог сходства для каждого текстового блока. Значение по умолчанию — 0.2. Текстовые блоки с более низкими оценками сходства отфильтровываются из итогового ответа.
   - **Vector similarity weight** по умолчанию равен 0.3. RAGFlow использует гибридную систему оценки релевантности различных текстовых блоков. Это значение задаёт вес, присваиваемый компоненту векторного сходства в гибридном скоре.
     - Если **Rerank model** оставлен пустым, гибридная система использует ключевое слово и векторное сходство, и вес, присваиваемый ключевому слову, равен 1-0.3=0.7.
     - Если **Rerank model** выбран, гибридная система использует ключевое слово и оценку переоценщика (reranker score), и вес, присваиваемый переоценщику, равен 1-0.7=0.3.
   - **Top N** определяет *максимальное* количество блоков, передаваемых в LLM. Другими словами, даже если найдено больше блоков, в качестве входных данных подаются только топ N блоков.
   - **Multi-turn optimization** улучшает запросы пользователя, используя существующий контекст в многораундовом разговоре. Включена по умолчанию. При включении потребляет дополнительные токены LLM и значительно увеличивает время генерации ответов.
   - **Use knowledge graph** указывает, использовать ли граф знаний в указанных наборах данных при поиске для многошагового ответа на вопросы. При включении это подразумевает итеративные поиски по сущностям, отношениям и отчетам сообществ, значительно увеличивая время поиска.
   - **Reasoning** указывает, генерировать ли ответы через процессы рассуждения, такие как Deepseek-R1/OpenAI o1. При включении модель чата автономно интегрирует Deep Research при ответах на вопросы по неизвестным темам. Это включает динамический поиск внешних знаний и генерацию итоговых ответов через рассуждения.
   - **Rerank model** задаёт модель переоценщика. По умолчанию оставлен пустым.
     - Если **Rerank model** пуст, гибридная система использует ключевое слово и векторное сходство, и вес, присваиваемый векторному сходству, равен 1-0.7=0.3.
     - Если **Rerank model** выбран, гибридная система использует ключевое слово и оценку переоценщика, и вес, присваиваемый переоценщику, равен 1-0.7=0.3.
   - [Cross-language search](../../references/glossary.mdx#cross-language-search): Опционально  
     Выберите один или несколько целевых языков из выпадающего меню. Система по умолчанию переведёт ваш запрос на выбранные языки. Этот перевод обеспечивает точное семантическое сопоставление между языками, позволяя получать релевантные результаты независимо от языковых различий.  
     - При выборе целевых языков убедитесь, что эти языки присутствуют в наборе данных для эффективного поиска.
     - Если целевой язык не выбран, система будет искать только на языке вашего запроса, что может привести к пропуску релевантной информации на других языках.
   - **Variable** — переменные (ключи), используемые в системной подсказке. `{knowledge}` — зарезервированная переменная. Нажмите **Add**, чтобы добавить дополнительные переменные для системной подсказки.
      - Если вы не уверены в логике работы **Variable**, оставьте *как есть*.
      - Начиная с версии v0.21.1, если вы добавляете здесь пользовательские переменные, единственный способ передать их значения — вызвать:
         - HTTP метод [Converse with chat assistant](../../references/http_api_reference.md#converse-with-chat-assistant), или
         - Python метод [Converse with chat assistant](../../references/python_api_reference.md#converse-with-chat-assistant).

4. Обновите настройки, специфичные для модели:

   - В разделе **Model** выберите модель чата. Несмотря на то, что вы выбрали модель по умолчанию в **System Model Settings**, RAGFlow позволяет выбрать альтернативную модель для вашего диалога.
   - **Creavity**: ярлык для настроек **Temperature**, **Top P**, **Presence penalty** и **Frequency penalty**, указывающий уровень свободы модели. От **Improvise**, **Precise** до **Balance** — каждая предустановка соответствует уникальному сочетанию этих параметров.  
   Параметр имеет три варианта:
      - **Improvise**: создаёт более креативные ответы.
      - **Precise**: (по умолчанию) создаёт более консервативные ответы.
      - **Balance**: компромисс между **Improvise** и **Precise**.
   - **Temperature**: уровень случайности вывода модели.  
   По умолчанию 0.1.
      - Более низкие значения ведут к более детерминированным и предсказуемым ответам.
      - Более высокие значения — к более креативным и разнообразным ответам.
      - Значение ноль приводит к одинаковому выводу для одинаковой подсказки.
   - **Top P**: ядерная выборка (nucleus sampling).  
      - Снижает вероятность генерации повторяющегося или неестественного текста, устанавливая порог *P* и ограничивая выбор токенов с кумулятивной вероятностью выше *P*.
      - По умолчанию 0.3.
   - **Presence penalty**: стимулирует модель включать более разнообразный набор токенов в ответ.  
      - Более высокое значение заставляет модель чаще генерировать токены, ещё не встречавшиеся в тексте.
      - По умолчанию 0.4.
   - **Frequency penalty**: препятствует повторению одних и тех же слов или фраз слишком часто.  
      - Более высокое значение заставляет модель быть более консервативной в использовании повторяющихся токенов.
      - По умолчанию 0.7.

5. Теперь начинаем шоу:

   ![chat_thermal_solution](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/chat_thermal_solution.jpg)

:::tip ЗАМЕТКА

1. Нажмите на иконку лампочки над ответом, чтобы увидеть расширенную системную подсказку:

![prompt_display](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/prompt_display.jpg)

   *Иконка лампочки доступна только для текущего диалога.*

2. Прокрутите вниз расширенную подсказку, чтобы увидеть время, затраченное на каждую задачу:

![time_elapsed](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/time_elapsed.jpg)
:::

## Обновление настроек существующего чат-ассистента

![chat_setting](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/chat_setting.jpg)

## Интеграция возможностей чата в ваше приложение или веб-страницу

RAGFlow предоставляет HTTP и Python API для интеграции возможностей RAGFlow в ваши приложения. Подробнее читайте в следующих документах:

- [Получение API-ключа RAGFlow](../../develop/acquire_ragflow_api_key.md)
- [Справочник HTTP API](../../references/http_api_reference.md)
- [Справочник Python API](../../references/python_api_reference.md)

Вы можете использовать iframe для встраивания созданного чат-ассистента на стороннюю веб-страницу:

1. Перед началом необходимо [получить API-ключ](../../develop/acquire_ragflow_api_key.md), иначе появится сообщение об ошибке.
2. Наведите курсор на нужного чат-ассистента **>** **Edit**, чтобы открыть окно **iframe**:

   ![chat-embed](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/embed_chat_into_webpage.jpg)

3. Скопируйте iframe и вставьте его на вашу веб-страницу.

![chat-embed](https://raw.githubusercontent.com/infiniflow/ragflow-docs/main/images/embedded_chat_app.jpg)